# 环境配置说明

## 1. 创建 .env.local 文件

在项目根目录创建 `.env.local` 文件，并填入以下配置：

```bash
# Supabase 配置
NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# 阿里邮箱 SMTP 配置
SMTP_HOST=smtp.qiye.aliyun.com
SMTP_PORT=465
SMTP_USER=your_email@yourdomain.com
SMTP_PASS=your_email_password
SMTP_FROM=51Talk 名片平台 <your_email@yourdomain.com>

# JWT 密钥
JWT_SECRET=your_jwt_secret_key_here

# 应用配置
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

## 2. Supabase 配置步骤

1. 访问 [Supabase](https://supabase.com) 创建新项目
2. 在项目设置中找到 API 配置
3. 复制 Project URL 和 API Keys
4. 将 `your_supabase_project_url` 替换为 Project URL
5. 将 `your_supabase_anon_key` 替换为 anon public key
6. 将 `your_supabase_service_role_key` 替换为 service_role secret key

## 3. 阿里邮箱配置

### 企业邮箱配置
- SMTP_HOST: smtp.qiye.aliyun.com
- SMTP_PORT: 465
- 需要开启SMTP服务并设置应用密码

### 个人邮箱配置
- SMTP_HOST: smtp.aliyun.com
- SMTP_PORT: 465
- 需要开启SMTP服务并设置应用密码

## 4. 数据库表结构

确保在Supabase中创建以下表：

```sql
-- 用户表
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  name VARCHAR(255),
  title VARCHAR(255),
  phone VARCHAR(50),
  students_served INTEGER DEFAULT 0,
  rating DECIMAL(3,2) DEFAULT 0.00,
  avatar_url TEXT,
  teacher_screening BOOLEAN DEFAULT false,
  feedback_ability BOOLEAN DEFAULT false,
  planning_ability BOOLEAN DEFAULT false,
  resource_sharing BOOLEAN DEFAULT false,
  is_admin BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 验证码表
CREATE TABLE verification_codes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) NOT NULL,
  code VARCHAR(10) NOT NULL,
  expires_at TIMESTAMP WITH TIME ZONE NOT NULL,
  used BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 使用统计表
CREATE TABLE usage_stats (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  action_type VARCHAR(50) NOT NULL,
  details JSONB,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

## 5. 测试步骤

1. 配置好环境变量后重启开发服务器
2. 访问注册页面测试邮箱验证码发送
3. 检查控制台日志确认邮件发送状态
4. 验证数据库连接是否正常
